<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Mini Brawl</title>
<style>
html,body{margin:0;overflow:hidden;background:#000}
#hp{position:fixed;top:10px;left:10px;color:white;font-family:Arial}
.joy{position:fixed;left:20px;bottom:20px;width:120px;height:120px;
border-radius:50%;background:rgba(255,255,255,.15)}
.knob{width:40px;height:40px;border-radius:50%;background:white;
position:absolute;left:40px;top:40px}
button{
position:fixed;width:70px;height:70px;border-radius:50%;
border:none;font-size:22px;color:black
}
#gadget{right:20px;bottom:110px;background:#00ff00}
#super{right:20px;bottom:20px;background:#ffdd00}
</style>
</head>
<body>

<div id="hp">HP: 100</div>
<div class="joy" id="joy"><div class="knob"></div></div>
<button id="gadget">ðŸŸ¢</button>
<button id="super">ðŸŸ¡</button>

<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>
<script>
const scene=new THREE.Scene();
scene.background=new THREE.Color(0x222222);

const camera=new THREE.PerspectiveCamera(60,innerWidth/innerHeight,.1,100);
camera.position.set(0,12,18);

const renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);
document.body.appendChild(renderer.domElement);

scene.add(new THREE.AmbientLight(0xffffff,1));

const floor=new THREE.Mesh(
new THREE.PlaneGeometry(50,50),
new THREE.MeshBasicMaterial({color:0x2f8f2f})
);
floor.rotation.x=-Math.PI/2;
scene.add(floor);

const player=new THREE.Mesh(
new THREE.CylinderGeometry(1,1,1.5,16),
new THREE.MeshBasicMaterial({color:0x00ffff})
);
player.position.y=.75;
scene.add(player);

let hp=100;
let speed=.25;
let joyX=0,joyY=0;

const enemies=[];

// joystick
const joy=document.getElementById("joy");
const knob=joy.querySelector(".knob");
joy.addEventListener("touchmove",e=>{
const r=joy.getBoundingClientRect();
let dx=e.touches[0].clientX-(r.left+r.width/2);
let dy=e.touches[0].clientY-(r.top+r.height/2);
const d=Math.hypot(dx,dy);
if(d>40){dx*=40/d;dy*=40/d}
knob.style.transform=`translate(${dx}px,${dy}px)`;
joyX=dx/40; joyY=dy/40;
},{passive:false});
joy.addEventListener("touchend",()=>{
joyX=joyY=0;knob.style.transform="";
});

// spawn enemies
for(let i=0;i<4;i++){
const e=new THREE.Mesh(
new THREE.BoxGeometry(2,2,2),
new THREE.MeshBasicMaterial({color:0xff3333})
);
e.position.set((Math.random()-0.5)*30,1,(Math.random()-0.5)*30);
scene.add(e);
enemies.push(e);
}

// buttons
document.getElementById("gadget").onclick=()=>{
hp=Math.min(100,hp+25);
document.getElementById("hp").innerText="HP: "+hp;
};

document.getElementById("super").onclick=()=>{
speed=1;
setTimeout(()=>speed=.25,350);
};

// loop
function loop(){
requestAnimationFrame(loop);

player.position.x+=joyX*speed;
player.position.z+=joyY*speed;

// enemy damage (touch = damage)
enemies.forEach(e=>{
if(player.position.distanceTo(e.position)<2){
hp-=0.2;
document.getElementById("hp").innerText="HP: "+Math.floor(hp);
}
});

// camera follow
camera.position.x+= (player.position.x-camera.position.x)*0.05;
camera.position.z+= (player.position.z+18-camera.position.z)*0.05;
camera.lookAt(player.position);

renderer.render(scene,camera);
}
loop();
</script>
</body>
</html>